{% extends "base.html" %}
{% block content %}
<h1>Expenses</h1>

<div class="mb-3">
  <a href="{% url 'expenses:expense_add' %}" class="btn btn-primary">Add expense</a>
</div>

<form method="get" class="row g-2 mb-3">
  <div class="col-md-3">
    <select name="category" class="form-select">
      <option value="">All categories</option>
      {% for category in categories %}
        <option value="{{ category.id }}" {% if selected_category|default:'' == category.id|stringformat:'s' %}selected{% endif %}>
          {{ category.name }}
        </option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <input type="date" name="date_from" class="form-control" value="{{ date_from }}">
  </div>
  <div class="col-md-3">
    <input type="date" name="date_to" class="form-control" value="{{ date_to }}">
  </div>
  <div class="col-md-3">
    <button type="submit" class="btn btn-secondary w-100">Filter</button>
  </div>
</form>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Date</th>
      <th>Category</th>
      <th>Description</th>
      <th>Amount</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for expense in expenses %}
    <tr>
      <td>{{ expense.date }}</td>
      <td>{{ expense.category|default:"(No category)" }}</td>
      <td>{{ expense.description }}</td>
      <td>{{ expense.amount }}</td>
      <td>
        <a href="{% url 'expenses:expense_edit' expense.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
        <a href="{% url 'expenses:expense_delete' expense.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="5">No expenses found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<nav>
  <ul class="pagination">
    {% if expenses.has_previous %}
      <li class="page-item"><a class="page-link" href="?page={{ expenses.previous_page_number }}">Previous</a></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Page {{ expenses.number }} of {{ expenses.paginator.num_pages }}</span></li>
    {% if expenses.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ expenses.next_page_number }}">Next</a></li>
    {% endif %}
  </ul>
</nav>

{% endblock %}
